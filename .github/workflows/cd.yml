name: CD Pipeline

on:
  workflow_run:
    workflows: ["CI Pipeline"]
    types:
     - completed

jobs:

    build:
        runs-on: self-hosted

        steps:
        - name: Log in to Docker Hub
          run: echo "${{ secrets.DOCKER_PASSWORD }}" | sudo docker login -u "${{ secrets.DOCKER_USERNAME }}" --password-stdin

        - name: pull docker image
          run: sudo docker pull ${{ secrets.DOCKER_USERNAME }}/gym-project:latest
                     
        - name: Run docker container
          run: sudo docker run -d -p 8080:8080 --name gym-project ${{ secrets.DOCKER_USERNAME }}/gym-project:latest

